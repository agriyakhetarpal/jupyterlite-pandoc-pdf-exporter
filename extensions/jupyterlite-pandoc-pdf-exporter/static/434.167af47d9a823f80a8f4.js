"use strict";(self.webpackChunkjupyterlite_pandoc_pdf_exporter=self.webpackChunkjupyterlite_pandoc_pdf_exporter||[]).push([[434],{968(t,e,n){n.d(e,{z:()=>v});const r=28,s=44,i=54,o=58;class a{static read_bytes(t,e){const n=new a;return n.buf=t.getUint32(e,!0),n.buf_len=t.getUint32(e+4,!0),n}static read_bytes_array(t,e,n){const r=[];for(let s=0;s<n;s++)r.push(a.read_bytes(t,e+8*s));return r}}class f{static read_bytes(t,e){const n=new f;return n.buf=t.getUint32(e,!0),n.buf_len=t.getUint32(e+4,!0),n}static read_bytes_array(t,e,n){const r=[];for(let s=0;s<n;s++)r.push(f.read_bytes(t,e+8*s));return r}}class l{head_length(){return 24}name_length(){return this.dir_name.byteLength}write_head_bytes(t,e){t.setBigUint64(e,this.d_next,!0),t.setBigUint64(e+8,this.d_ino,!0),t.setUint32(e+16,this.dir_name.length,!0),t.setUint8(e+20,this.d_type)}write_name_bytes(t,e,n){t.set(this.dir_name.slice(0,Math.min(this.dir_name.byteLength,n)),e)}constructor(t,e,n,r){const s=(new TextEncoder).encode(n);this.d_next=t,this.d_ino=e,this.d_namlen=s.byteLength,this.d_type=r,this.dir_name=s}}class d{write_bytes(t,e){t.setUint8(e,this.fs_filetype),t.setUint16(e+2,this.fs_flags,!0),t.setBigUint64(e+8,this.fs_rights_base,!0),t.setBigUint64(e+16,this.fs_rights_inherited,!0)}constructor(t,e){this.fs_rights_base=0n,this.fs_rights_inherited=0n,this.fs_filetype=t,this.fs_flags=e}}class u{write_bytes(t,e){t.setBigUint64(e,this.dev,!0),t.setBigUint64(e+8,this.ino,!0),t.setUint8(e+16,this.filetype),t.setBigUint64(e+24,this.nlink,!0),t.setBigUint64(e+32,this.size,!0),t.setBigUint64(e+38,this.atim,!0),t.setBigUint64(e+46,this.mtim,!0),t.setBigUint64(e+52,this.ctim,!0)}constructor(t,e,n){this.dev=0n,this.nlink=0n,this.atim=0n,this.mtim=0n,this.ctim=0n,this.ino=t,this.filetype=e,this.size=n}}class c{static read_bytes(t,e){return new c(t.getBigUint64(e,!0),t.getUint8(e+8),t.getUint32(e+16,!0),t.getBigUint64(e+24,!0),t.getUint16(e+36,!0))}constructor(t,e,n,r,s){this.userdata=t,this.eventtype=e,this.clockid=n,this.timeout=r,this.flags=s}}class _{write_bytes(t,e){t.setBigUint64(e,this.userdata,!0),t.setUint16(e+8,this.error,!0),t.setUint8(e+10,this.eventtype)}constructor(t,e,n){this.userdata=t,this.error=e,this.eventtype=n}}class h{write_bytes(t,e){t.setUint32(e,this.pr_name.byteLength,!0)}constructor(t){this.pr_name=(new TextEncoder).encode(t)}}class p{static dir(t){const e=new p;return e.tag=0,e.inner=new h(t),e}write_bytes(t,e){t.setUint32(e,this.tag,!0),this.inner.write_bytes(t,e+4)}}const y=new class{enable(t){this.log=function(t,e){return t?console.log.bind(console,"%c%s","color: #265BA0",e):()=>{}}(void 0===t||t,this.prefix)}get enabled(){return this.isEnabled}constructor(t){this.isEnabled=t,this.prefix="wasi:",this.enable(t)}}(!1);class w extends Error{constructor(t){super("exit with exit code "+t),this.code=t}}let g=class{start(t){this.inst=t;try{return t.exports._start(),0}catch(t){if(t instanceof w)return t.code;throw t}}initialize(t){this.inst=t,t.exports._initialize&&t.exports._initialize()}constructor(t,e,n,s={}){this.args=[],this.env=[],this.fds=[],y.enable(s.debug),this.args=t,this.env=e,this.fds=n;const i=this;this.wasiImport={args_sizes_get(t,e){const n=new DataView(i.inst.exports.memory.buffer);n.setUint32(t,i.args.length,!0);let r=0;for(const t of i.args)r+=t.length+1;return n.setUint32(e,r,!0),y.log(n.getUint32(t,!0),n.getUint32(e,!0)),0},args_get(t,e){const n=new DataView(i.inst.exports.memory.buffer),r=new Uint8Array(i.inst.exports.memory.buffer),s=e;for(let s=0;s<i.args.length;s++){n.setUint32(t,e,!0),t+=4;const o=(new TextEncoder).encode(i.args[s]);r.set(o,e),n.setUint8(e+o.length,0),e+=o.length+1}return y.enabled&&y.log(new TextDecoder("utf-8").decode(r.slice(s,e))),0},environ_sizes_get(t,e){const n=new DataView(i.inst.exports.memory.buffer);n.setUint32(t,i.env.length,!0);let r=0;for(const t of i.env)r+=(new TextEncoder).encode(t).length+1;return n.setUint32(e,r,!0),y.log(n.getUint32(t,!0),n.getUint32(e,!0)),0},environ_get(t,e){const n=new DataView(i.inst.exports.memory.buffer),r=new Uint8Array(i.inst.exports.memory.buffer),s=e;for(let s=0;s<i.env.length;s++){n.setUint32(t,e,!0),t+=4;const o=(new TextEncoder).encode(i.env[s]);r.set(o,e),n.setUint8(e+o.length,0),e+=o.length+1}return y.enabled&&y.log(new TextDecoder("utf-8").decode(r.slice(s,e))),0},clock_res_get(t,e){let n;switch(t){case 1:n=5000n;break;case 0:n=1000000n;break;default:return 52}return new DataView(i.inst.exports.memory.buffer).setBigUint64(e,n,!0),0},clock_time_get(t,e,n){const r=new DataView(i.inst.exports.memory.buffer);if(0===t)r.setBigUint64(n,1000000n*BigInt((new Date).getTime()),!0);else if(1==t){let t;try{t=BigInt(Math.round(1e6*performance.now()))}catch(e){t=0n}r.setBigUint64(n,t,!0)}else r.setBigUint64(n,0n,!0);return 0},fd_advise:(t,e,n,r)=>null!=i.fds[t]?0:8,fd_allocate:(t,e,n)=>null!=i.fds[t]?i.fds[t].fd_allocate(e,n):8,fd_close(t){if(null!=i.fds[t]){const e=i.fds[t].fd_close();return i.fds[t]=void 0,e}return 8},fd_datasync:t=>null!=i.fds[t]?i.fds[t].fd_sync():8,fd_fdstat_get(t,e){if(null!=i.fds[t]){const{ret:n,fdstat:r}=i.fds[t].fd_fdstat_get();return null!=r&&r.write_bytes(new DataView(i.inst.exports.memory.buffer),e),n}return 8},fd_fdstat_set_flags:(t,e)=>null!=i.fds[t]?i.fds[t].fd_fdstat_set_flags(e):8,fd_fdstat_set_rights:(t,e,n)=>null!=i.fds[t]?i.fds[t].fd_fdstat_set_rights(e,n):8,fd_filestat_get(t,e){if(null!=i.fds[t]){const{ret:n,filestat:r}=i.fds[t].fd_filestat_get();return null!=r&&r.write_bytes(new DataView(i.inst.exports.memory.buffer),e),n}return 8},fd_filestat_set_size:(t,e)=>null!=i.fds[t]?i.fds[t].fd_filestat_set_size(e):8,fd_filestat_set_times:(t,e,n,r)=>null!=i.fds[t]?i.fds[t].fd_filestat_set_times(e,n,r):8,fd_pread(t,e,n,r,s){const o=new DataView(i.inst.exports.memory.buffer),f=new Uint8Array(i.inst.exports.memory.buffer);if(null!=i.fds[t]){const l=a.read_bytes_array(o,e,n);let d=0;for(const e of l){const{ret:n,data:a}=i.fds[t].fd_pread(e.buf_len,r);if(0!=n)return o.setUint32(s,d,!0),n;if(f.set(a,e.buf),d+=a.length,r+=BigInt(a.length),a.length!=e.buf_len)break}return o.setUint32(s,d,!0),0}return 8},fd_prestat_get(t,e){const n=new DataView(i.inst.exports.memory.buffer);if(null!=i.fds[t]){const{ret:r,prestat:s}=i.fds[t].fd_prestat_get();return null!=s&&s.write_bytes(n,e),r}return 8},fd_prestat_dir_name(t,e,n){if(null!=i.fds[t]){const{ret:r,prestat:s}=i.fds[t].fd_prestat_get();if(null==s)return r;const o=s.inner.pr_name;return new Uint8Array(i.inst.exports.memory.buffer).set(o.slice(0,n),e),o.byteLength>n?37:0}return 8},fd_pwrite(t,e,n,r,s){const o=new DataView(i.inst.exports.memory.buffer),a=new Uint8Array(i.inst.exports.memory.buffer);if(null!=i.fds[t]){const l=f.read_bytes_array(o,e,n);let d=0;for(const e of l){const n=a.slice(e.buf,e.buf+e.buf_len),{ret:f,nwritten:l}=i.fds[t].fd_pwrite(n,r);if(0!=f)return o.setUint32(s,d,!0),f;if(d+=l,r+=BigInt(l),l!=n.byteLength)break}return o.setUint32(s,d,!0),0}return 8},fd_read(t,e,n,r){const s=new DataView(i.inst.exports.memory.buffer),o=new Uint8Array(i.inst.exports.memory.buffer);if(null!=i.fds[t]){const f=a.read_bytes_array(s,e,n);let l=0;for(const e of f){const{ret:n,data:a}=i.fds[t].fd_read(e.buf_len);if(0!=n)return s.setUint32(r,l,!0),n;if(o.set(a,e.buf),l+=a.length,a.length!=e.buf_len)break}return s.setUint32(r,l,!0),0}return 8},fd_readdir(t,e,n,r,s){const o=new DataView(i.inst.exports.memory.buffer),a=new Uint8Array(i.inst.exports.memory.buffer);if(null!=i.fds[t]){let f=0;for(;;){const{ret:l,dirent:d}=i.fds[t].fd_readdir_single(r);if(0!=l)return o.setUint32(s,f,!0),l;if(null==d)break;if(n-f<d.head_length()){f=n;break}const u=new ArrayBuffer(d.head_length());if(d.write_head_bytes(new DataView(u),0),a.set(new Uint8Array(u).slice(0,Math.min(u.byteLength,n-f)),e),e+=d.head_length(),f+=d.head_length(),n-f<d.name_length()){f=n;break}d.write_name_bytes(a,e,n-f),e+=d.name_length(),f+=d.name_length(),r=d.d_next}return o.setUint32(s,f,!0),0}return 8},fd_renumber(t,e){if(null!=i.fds[t]&&null!=i.fds[e]){const n=i.fds[e].fd_close();return 0!=n?n:(i.fds[e]=i.fds[t],i.fds[t]=void 0,0)}return 8},fd_seek(t,e,n,r){const s=new DataView(i.inst.exports.memory.buffer);if(null!=i.fds[t]){const{ret:o,offset:a}=i.fds[t].fd_seek(e,n);return s.setBigInt64(r,a,!0),o}return 8},fd_sync:t=>null!=i.fds[t]?i.fds[t].fd_sync():8,fd_tell(t,e){const n=new DataView(i.inst.exports.memory.buffer);if(null!=i.fds[t]){const{ret:r,offset:s}=i.fds[t].fd_tell();return n.setBigUint64(e,s,!0),r}return 8},fd_write(t,e,n,r){const s=new DataView(i.inst.exports.memory.buffer),o=new Uint8Array(i.inst.exports.memory.buffer);if(null!=i.fds[t]){const a=f.read_bytes_array(s,e,n);let l=0;for(const e of a){const n=o.slice(e.buf,e.buf+e.buf_len),{ret:a,nwritten:f}=i.fds[t].fd_write(n);if(0!=a)return s.setUint32(r,l,!0),a;if(l+=f,f!=n.byteLength)break}return s.setUint32(r,l,!0),0}return 8},path_create_directory(t,e,n){const r=new Uint8Array(i.inst.exports.memory.buffer);if(null!=i.fds[t]){const s=new TextDecoder("utf-8").decode(r.slice(e,e+n));return i.fds[t].path_create_directory(s)}return 8},path_filestat_get(t,e,n,r,s){const o=new DataView(i.inst.exports.memory.buffer),a=new Uint8Array(i.inst.exports.memory.buffer);if(null!=i.fds[t]){const f=new TextDecoder("utf-8").decode(a.slice(n,n+r)),{ret:l,filestat:d}=i.fds[t].path_filestat_get(e,f);return null!=d&&d.write_bytes(o,s),l}return 8},path_filestat_set_times(t,e,n,r,s,o,a){const f=new Uint8Array(i.inst.exports.memory.buffer);if(null!=i.fds[t]){const l=new TextDecoder("utf-8").decode(f.slice(n,n+r));return i.fds[t].path_filestat_set_times(e,l,s,o,a)}return 8},path_link(t,e,n,r,s,o,a){const f=new Uint8Array(i.inst.exports.memory.buffer);if(null!=i.fds[t]&&null!=i.fds[s]){const l=new TextDecoder("utf-8").decode(f.slice(n,n+r)),d=new TextDecoder("utf-8").decode(f.slice(o,o+a)),{ret:u,inode_obj:c}=i.fds[t].path_lookup(l,e);return null==c?u:i.fds[s].path_link(d,c,!1)}return 8},path_open(t,e,n,r,s,o,a,f,l){const d=new DataView(i.inst.exports.memory.buffer),u=new Uint8Array(i.inst.exports.memory.buffer);if(null!=i.fds[t]){const c=new TextDecoder("utf-8").decode(u.slice(n,n+r));y.log(c);const{ret:_,fd_obj:h}=i.fds[t].path_open(e,c,s,o,a,f);if(0!=_)return _;i.fds.push(h);const p=i.fds.length-1;return d.setUint32(l,p,!0),0}return 8},path_readlink(t,e,n,r,s,o){const a=new DataView(i.inst.exports.memory.buffer),f=new Uint8Array(i.inst.exports.memory.buffer);if(null!=i.fds[t]){const l=new TextDecoder("utf-8").decode(f.slice(e,e+n));y.log(l);const{ret:d,data:u}=i.fds[t].path_readlink(l);if(null!=u){const t=(new TextEncoder).encode(u);if(t.length>s)return a.setUint32(o,0,!0),8;f.set(t,r),a.setUint32(o,t.length,!0)}return d}return 8},path_remove_directory(t,e,n){const r=new Uint8Array(i.inst.exports.memory.buffer);if(null!=i.fds[t]){const s=new TextDecoder("utf-8").decode(r.slice(e,e+n));return i.fds[t].path_remove_directory(s)}return 8},path_rename(t,e,n,r,s,o){const a=new Uint8Array(i.inst.exports.memory.buffer);if(null!=i.fds[t]&&null!=i.fds[r]){const f=new TextDecoder("utf-8").decode(a.slice(e,e+n)),l=new TextDecoder("utf-8").decode(a.slice(s,s+o));let{ret:d,inode_obj:u}=i.fds[t].path_unlink(f);if(null==u)return d;if(d=i.fds[r].path_link(l,u,!0),0!=d&&0!=i.fds[t].path_link(f,u,!0))throw"path_link should always return success when relinking an inode back to the original place";return d}return 8},path_symlink(t,e,n,r,s){const a=new Uint8Array(i.inst.exports.memory.buffer);return null!=i.fds[n]?(new TextDecoder("utf-8").decode(a.slice(t,t+e)),new TextDecoder("utf-8").decode(a.slice(r,r+s)),o):8},path_unlink_file(t,e,n){const r=new Uint8Array(i.inst.exports.memory.buffer);if(null!=i.fds[t]){const s=new TextDecoder("utf-8").decode(r.slice(e,e+n));return i.fds[t].path_unlink_file(s)}return 8},poll_oneoff(t,e,n){if(0===n)return r;if(n>1)return y.log("poll_oneoff: only a single subscription is supported"),o;const s=new DataView(i.inst.exports.memory.buffer),a=c.read_bytes(s,t),f=a.eventtype,l=a.clockid,d=a.timeout;if(0!==f)return y.log("poll_oneoff: only clock subscriptions are supported"),o;let u;if(1===l)u=()=>BigInt(Math.round(1e6*performance.now()));else{if(0!==l)return r;u=()=>1000000n*BigInt((new Date).getTime())}const h=1&a.flags?d:u()+d;for(;h>u(););return new _(a.userdata,0,f).write_bytes(s,e),0},proc_exit(t){throw new w(t)},proc_raise(t){throw"raised signal "+t},sched_yield(){},random_get(t,e){const n=new Uint8Array(i.inst.exports.memory.buffer).subarray(t,t+e);if(!("crypto"in globalThis)||"undefined"!=typeof SharedArrayBuffer&&i.inst.exports.memory.buffer instanceof SharedArrayBuffer)for(let t=0;t<e;t++)n[t]=256*Math.random()|0;else for(let t=0;t<e;t+=65536)crypto.getRandomValues(n.subarray(t,t+65536))},sock_recv(t,e,n){throw"sockets not supported"},sock_send(t,e,n){throw"sockets not supported"},sock_shutdown(t,e){throw"sockets not supported"},sock_accept(t,e){throw"sockets not supported"}}}};class m{fd_allocate(t,e){return o}fd_close(){return 0}fd_fdstat_get(){return{ret:o,fdstat:null}}fd_fdstat_set_flags(t){return o}fd_fdstat_set_rights(t,e){return o}fd_filestat_get(){return{ret:o,filestat:null}}fd_filestat_set_size(t){return o}fd_filestat_set_times(t,e,n){return o}fd_pread(t,e){return{ret:o,data:new Uint8Array}}fd_prestat_get(){return{ret:o,prestat:null}}fd_pwrite(t,e){return{ret:o,nwritten:0}}fd_read(t){return{ret:o,data:new Uint8Array}}fd_readdir_single(t){return{ret:o,dirent:null}}fd_seek(t,e){return{ret:o,offset:0n}}fd_sync(){return 0}fd_tell(){return{ret:o,offset:0n}}fd_write(t){return{ret:o,nwritten:0}}path_create_directory(t){return o}path_filestat_get(t,e){return{ret:o,filestat:null}}path_filestat_set_times(t,e,n,r,s){return o}path_link(t,e,n){return o}path_unlink(t){return{ret:o,inode_obj:null}}path_lookup(t,e){return{ret:o,inode_obj:null}}path_open(t,e,n,r,s,o){return{ret:i,fd_obj:null}}path_readlink(t){return{ret:o,data:null}}path_remove_directory(t){return o}path_rename(t,e,n){return o}path_unlink_file(t){return o}}class b{static issue_ino(){return b.next_ino++}static root_ino(){return 0n}constructor(){this.ino=b.issue_ino()}}b.next_ino=1n;class x extends m{fd_allocate(t,e){if(this.file.size>t+e);else{const n=new Uint8Array(Number(t+e));n.set(this.file.data,0),this.file.data=n}return 0}fd_fdstat_get(){return{ret:0,fdstat:new d(4,0)}}fd_filestat_set_size(t){if(this.file.size>t)this.file.data=new Uint8Array(this.file.data.buffer.slice(0,Number(t)));else{const e=new Uint8Array(Number(t));e.set(this.file.data,0),this.file.data=e}return 0}fd_read(t){const e=this.file.data.slice(Number(this.file_pos),Number(this.file_pos+BigInt(t)));return this.file_pos+=BigInt(e.length),{ret:0,data:e}}fd_pread(t,e){return{ret:0,data:this.file.data.slice(Number(e),Number(e+BigInt(t)))}}fd_seek(t,e){let n;switch(e){case 0:n=t;break;case 1:n=this.file_pos+t;break;case 2:n=BigInt(this.file.data.byteLength)+t;break;default:return{ret:r,offset:0n}}return n<0?{ret:r,offset:0n}:(this.file_pos=n,{ret:0,offset:this.file_pos})}fd_tell(){return{ret:0,offset:this.file_pos}}fd_write(t){if(this.file.readonly)return{ret:8,nwritten:0};if(this.file_pos+BigInt(t.byteLength)>this.file.size){const e=this.file.data;this.file.data=new Uint8Array(Number(this.file_pos+BigInt(t.byteLength))),this.file.data.set(e)}return this.file.data.set(t,Number(this.file_pos)),this.file_pos+=BigInt(t.byteLength),{ret:0,nwritten:t.byteLength}}fd_pwrite(t,e){if(this.file.readonly)return{ret:8,nwritten:0};if(e+BigInt(t.byteLength)>this.file.size){const n=this.file.data;this.file.data=new Uint8Array(Number(e+BigInt(t.byteLength))),this.file.data.set(n)}return this.file.data.set(t,Number(e)),{ret:0,nwritten:t.byteLength}}fd_filestat_get(){return{ret:0,filestat:this.file.stat()}}constructor(t){super(),this.file_pos=0n,this.file=t}}class U extends m{fd_seek(t,e){return{ret:8,offset:0n}}fd_tell(){return{ret:8,offset:0n}}fd_allocate(t,e){return 8}fd_fdstat_get(){return{ret:0,fdstat:new d(3,0)}}fd_readdir_single(t){if(y.enabled&&(y.log("readdir_single",t),y.log(t,this.dir.contents.keys())),0n==t)return{ret:0,dirent:new l(1n,this.dir.ino,".",3)};if(1n==t)return{ret:0,dirent:new l(2n,this.dir.parent_ino(),"..",3)};if(t>=BigInt(this.dir.contents.size)+2n)return{ret:0,dirent:null};const[e,n]=Array.from(this.dir.contents.entries())[Number(t-2n)];return{ret:0,dirent:new l(t+1n,n.ino,e,n.stat().filetype)}}path_filestat_get(t,e){const{ret:n,path:r}=A.from(e);if(null==r)return{ret:n,filestat:null};const{ret:s,entry:i}=this.dir.get_entry_for_path(r);return null==i?{ret:s,filestat:null}:{ret:0,filestat:i.stat()}}path_lookup(t,e){const{ret:n,path:r}=A.from(t);if(null==r)return{ret:n,inode_obj:null};const{ret:s,entry:i}=this.dir.get_entry_for_path(r);return null==i?{ret:s,inode_obj:null}:{ret:0,inode_obj:i}}path_open(t,e,n,r,o,a){const{ret:f,path:l}=A.from(e);if(null==l)return{ret:f,fd_obj:null};let{ret:d,entry:u}=this.dir.get_entry_for_path(l);if(null==u){if(d!=s)return{ret:d,fd_obj:null};if(1&~n)return{ret:s,fd_obj:null};{const{ret:t,entry:r}=this.dir.create_entry_for_path(e,!(2&~n));if(null==r)return{ret:t,fd_obj:null};u=r}}else if(!(4&~n))return{ret:20,fd_obj:null};return 2&~n||3===u.stat().filetype?u.path_open(n,r,a):{ret:i,fd_obj:null}}path_create_directory(t){return this.path_open(0,t,3,0n,0n,0).ret}path_link(t,e,n){const{ret:r,path:o}=A.from(t);if(null==o)return r;if(o.is_dir)return s;const{ret:a,parent_entry:f,filename:l,entry:d}=this.dir.get_parent_dir_and_entry_for_path(o,!0);if(null==f||null==l)return a;if(null!=d){const t=3==e.stat().filetype,r=3==d.stat().filetype;if(t&&r){if(!(n&&d instanceof D))return 20;if(0!=d.contents.size)return 55}else{if(t&&!r)return i;if(!t&&r)return 31;if(4!=e.stat().filetype||4!=d.stat().filetype)return 20}}return n||3!=e.stat().filetype?(f.contents.set(l,e),0):63}path_unlink(t){const{ret:e,path:n}=A.from(t);if(null==n)return{ret:e,inode_obj:null};const{ret:r,parent_entry:i,filename:o,entry:a}=this.dir.get_parent_dir_and_entry_for_path(n,!0);return null==i||null==o?{ret:r,inode_obj:null}:null==a?{ret:s,inode_obj:null}:(i.contents.delete(o),{ret:0,inode_obj:a})}path_unlink_file(t){const{ret:e,path:n}=A.from(t);if(null==n)return e;const{ret:r,parent_entry:s,filename:i,entry:o}=this.dir.get_parent_dir_and_entry_for_path(n,!1);return null==s||null==i||null==o?r:3===o.stat().filetype?31:(s.contents.delete(i),0)}path_remove_directory(t){const{ret:e,path:n}=A.from(t);if(null==n)return e;const{ret:r,parent_entry:o,filename:a,entry:f}=this.dir.get_parent_dir_and_entry_for_path(n,!1);return null==o||null==a||null==f?r:f instanceof D&&3===f.stat().filetype?0!==f.contents.size?55:o.contents.delete(a)?0:s:i}fd_filestat_get(){return{ret:0,filestat:this.dir.stat()}}fd_filestat_set_size(t){return 8}fd_read(t){return{ret:8,data:new Uint8Array}}fd_pread(t,e){return{ret:8,data:new Uint8Array}}fd_write(t){return{ret:8,nwritten:0}}fd_pwrite(t,e){return{ret:8,nwritten:0}}constructor(t){super(),this.dir=t}}class B extends U{fd_prestat_get(){return{ret:0,prestat:p.dir(this.prestat_name)}}constructor(t,e){super(new D(e)),this.prestat_name=t}}class k extends b{path_open(t,e,n){if(this.readonly&&(e&BigInt(64))==BigInt(64))return{ret:63,fd_obj:null};if(!(8&~t)){if(this.readonly)return{ret:63,fd_obj:null};this.data=new Uint8Array([])}const r=new x(this);return 1&n&&r.fd_seek(0n,2),{ret:0,fd_obj:r}}get size(){return BigInt(this.data.byteLength)}stat(){return new u(this.ino,4,this.size)}constructor(t,e){super(),this.data=new Uint8Array(t),this.readonly=!!e?.readonly}}let A=class t{static from(e){const n=new t;if(n.is_dir=e.endsWith("/"),e.startsWith("/"))return{ret:76,path:null};if(e.includes("\0"))return{ret:r,path:null};for(const t of e.split("/"))if(""!==t&&"."!==t)if(".."!==t)n.parts.push(t);else if(null==n.parts.pop())return{ret:76,path:null};return{ret:0,path:n}}to_path_string(){let t=this.parts.join("/");return this.is_dir&&(t+="/"),t}constructor(){this.parts=[],this.is_dir=!1}};class D extends b{parent_ino(){return null==this.parent?b.root_ino():this.parent.ino}path_open(t,e,n){return{ret:0,fd_obj:new U(this)}}stat(){return new u(this.ino,3,0n)}get_entry_for_path(t){let e=this;for(const n of t.parts){if(!(e instanceof D))return{ret:i,entry:null};const t=e.contents.get(n);if(void 0===t)return y.log(n),{ret:s,entry:null};e=t}return t.is_dir&&3!=e.stat().filetype?{ret:i,entry:null}:{ret:0,entry:e}}get_parent_dir_and_entry_for_path(t,e){const n=t.parts.pop();if(void 0===n)return{ret:r,parent_entry:null,filename:null,entry:null};const{ret:o,entry:a}=this.get_entry_for_path(t);if(null==a)return{ret:o,parent_entry:null,filename:null,entry:null};if(!(a instanceof D))return{ret:i,parent_entry:null,filename:null,entry:null};const f=a.contents.get(n);return void 0===f?e?{ret:0,parent_entry:a,filename:n,entry:null}:{ret:s,parent_entry:null,filename:null,entry:null}:t.is_dir&&3!=f.stat().filetype?{ret:i,parent_entry:null,filename:null,entry:null}:{ret:0,parent_entry:a,filename:n,entry:f}}create_entry_for_path(t,e){const{ret:n,path:r}=A.from(t);if(null==r)return{ret:n,entry:null};let s,{ret:i,parent_entry:o,filename:a,entry:f}=this.get_parent_dir_and_entry_for_path(r,!0);return null==o||null==a?{ret:i,entry:null}:null!=f?{ret:20,entry:null}:(y.log("create",r),s=e?new D(new Map):new k(new ArrayBuffer(0)),o.contents.set(a,s),f=s,{ret:0,entry:f})}constructor(t){super(),this.parent=null,this.contents=t instanceof Array?new Map(t):t;for(const t of this.contents.values())t instanceof D&&(t.parent=this)}}class T extends m{fd_filestat_get(){return{ret:0,filestat:new u(this.ino,2,BigInt(0))}}fd_fdstat_get(){const t=new d(2,0);return t.fs_rights_base=BigInt(64),{ret:0,fdstat:t}}fd_write(t){return this.write(t),{ret:0,nwritten:t.byteLength}}static lineBuffered(t){const e=new TextDecoder("utf-8",{fatal:!1});let n="";return new T(r=>{n+=e.decode(r,{stream:!0});const s=n.split("\n");for(const[e,r]of s.entries())e<s.length-1?t(r):n=r})}constructor(t){super(),this.ino=b.issue_ino(),this.write=t}}function v(t){const e=["pandoc.wasm","+RTS","-H64m","-RTS"],n=new Map,r=[new x(new k(new Uint8Array,{readonly:!0})),T.lineBuffered(t=>console.log(`[WASI stdout] ${t}`)),T.lineBuffered(t=>console.warn(`[WASI stderr] ${t}`)),new B("/",n)],s=new g(e,[],r,{debug:!1});return WebAssembly.instantiate(t,{wasi_snapshot_preview1:s.wasiImport}).then(({instance:t})=>{function r(){return new DataView(t.exports.memory.buffer)}s.initialize(t),t.exports.__wasm_call_ctors();const i=t.exports.malloc(4);r().setUint32(i,e.length,!0);const o=t.exports.malloc(4*(e.length+1));for(let n=0;n<e.length;++n){const s=t.exports.malloc(e[n].length+1);(new TextEncoder).encodeInto(e[n],new Uint8Array(t.exports.memory.buffer,s,e[n].length)),r().setUint8(s+e[n].length,0),r().setUint32(o+4*n,s,!0)}r().setUint32(o+4*e.length,0,!0);const a=t.exports.malloc(4);async function f(t,e,r){let s;if("string"==typeof e)s=(new TextEncoder).encode(e);else{const t=await e.arrayBuffer();s=new Uint8Array(t)}const i=new k(s,{readonly:r});n.set(t,i)}async function l(e,r,s){const i=JSON.stringify(e),o=(new TextEncoder).encode(i),a=t.exports.malloc(o.length);(new TextEncoder).encodeInto(i,new Uint8Array(t.exports.memory.buffer,a,o.length)),s={...s},n.clear();const l=new k(new Uint8Array,{readonly:!0}),d=new k(new Uint8Array,{readonly:!1}),u=new k(new Uint8Array,{readonly:!1}),c=new k(new Uint8Array,{readonly:!1});n.set("stdin",l),n.set("stdout",d),n.set("stderr",u),n.set("warnings",c);const _=new Set(["stdin","stdout","stderr","warnings"]);for(const t in s)await f(t,s[t],!0),_.add(t);const h=e["output-file"]||null,p=e["extract-media"]||null;if(h&&(await f(h,new Blob,!1),_.add(h)),p&&(await f(p,new Blob,!1),p.endsWith(".zip")&&_.add(p)),r&&(l.data=(new TextEncoder).encode(r)),t.exports.convert(a,o.length),e["output-file"]){const t=n.get(e["output-file"]);t&&t.data&&t.data.length>0&&(s[e["output-file"]]=new Blob([t.data]))}if(e["extract-media"]){const t=n.get(e["extract-media"]);t&&t.data&&t.data.length>0&&(s[e["extract-media"]]=new Blob([t.data],{type:"application/zip"}))}const y={};for(const[t,e]of n.entries())if(!_.has(t)&&e&&e.data&&e.data.length>0){const n=new Blob([e.data]);s[t]=n,t!==h&&t!==p&&(y[t]=n)}const w=new TextDecoder("utf-8",{fatal:!0}).decode(c.data);let g=[];if(w)try{g=JSON.parse(w)}catch(t){console.warn("Failed to parse warnings:",t)}return{stdout:new TextDecoder("utf-8",{fatal:!0}).decode(d.data),stderr:new TextDecoder("utf-8",{fatal:!0}).decode(u.data),warnings:g,files:s,mediaFiles:y}}async function d(t){let e;if("string"==typeof t)e=(new TextEncoder).encode(t);else{if(!(t instanceof Blob))throw new Error("Unsupported type: inData must be a string or a Blob");{const n=await t.arrayBuffer();e=new Uint8Array(n)}}return e}r().setUint32(a,o,!0),t.exports.hs_init_with_rtsopts(i,a);const u=new TextDecoder("utf-8",{fatal:!0});function c(t){let e;try{e=u.decode(t)}catch(n){e=new Blob([t])}return e}return{convert:l,query:function(e){const r=JSON.stringify(e),s=(new TextEncoder).encode(r),i=t.exports.malloc(s.length);(new TextEncoder).encodeInto(r,new Uint8Array(t.exports.memory.buffer,i,s.length)),n.clear();const o=new k(new Uint8Array,{readonly:!1}),a=new k(new Uint8Array,{readonly:!1});n.set("stdout",o),n.set("stderr",a),t.exports.query(i,s.length);const f=new TextDecoder("utf-8",{fatal:!0}).decode(a.data);f&&console.log(f);const l=new TextDecoder("utf-8",{fatal:!0}).decode(o.data);return JSON.parse(l)},pandoc:async function(t,e,n=[]){const r=t.trim().split(/\s+/),s={},i={};let o=0;for(;o<r.length;){const t=r[o];"-f"===t||"--from"===t?s.from=r[++o]:"-t"===t||"--to"===t?s.to=r[++o]:"-o"===t||"--output"===t?s["output-file"]=r[++o]:"-s"===t||"--standalone"===t?s.standalone=!0:"--extract-media"===t?s["extract-media"]=r[++o]:"--toc"!==t&&"--table-of-contents"!==t||(s["table-of-contents"]=!0),o++}for(const t of n)if("string"==typeof t.contents)i[t.filename]=t.contents;else{const e=await d(t.contents);i[t.filename]=new Blob([e])}let a=null;if(e)if("string"==typeof e)a=e;else{const t=await d(e);a=new TextDecoder("utf-8").decode(t)}const f=await l(s,a,i),u=new Map;for(const[t,e]of Object.entries(f.mediaFiles))u.set(t,c(new Uint8Array(await e.arrayBuffer())));let _;return _=s["output-file"]&&f.files[s["output-file"]]?c(new Uint8Array(await f.files[s["output-file"]].arrayBuffer())):f.stdout,{out:_,mediaFiles:u}}}})}},434(t,e,n){n.a(t,async(t,r)=>{try{n.r(e),n.d(e,{convert:()=>f,pandoc:()=>d,query:()=>l});var s=n(968);const t=(await n.e(751).then(n.t.bind(n,751,17))).default,i=await fetch(t),o=await i.arrayBuffer(),a=await(0,s.z)(o),f=a.convert,l=a.query,d=a.pandoc;r()}catch(t){r(t)}},1)}}]);